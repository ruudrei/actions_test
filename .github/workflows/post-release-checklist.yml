name: Post release checklist

on:
    release:
        types: [published]

jobs:
    update_discussion:
        runs-on: ubuntu-latest
        permissions:
            discussions: write
            contents: read

        steps:
            - name: Checkout repository
              uses: actions/checkout@v4

            # - name: Debug workspace
            #   run: |
            #       pwd
            #       ls -R .

            # - name: Make script executable
            #   run: chmod +x scripts/update_discussion_table.sh

            - name: Update discussion table
              env:
                  GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
                  REPO: ${{ github.repository }}
                  TITLE: ${{ github.event.release.name }}
                  DISCUSSION_TITLE: "リリース反映チェックリスト"
                  CUSTOMERS_CSV: "株式会社A,株式会社B,株式会社C"
              run: |
                  bash scripts/update_discussion_table.sh
