name: Post release checklist

on:
    release:
        types: [published]

jobs:
    update_discussion:
        runs-on: ubuntu-latest
        permissions:
            discussions: write
            contents: read
        steps:
            - uses: actions/checkout@v4
            - name: Lint shell
              uses: ludeeus/action-shellcheck@2.0.0
              with: { severity: error }
            - name: actionlint
              uses: reviewdog/action-actionlint@v1
              with:
                  reporter: github-pr-check
            - name: Update discussion table
              env:
                  GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
                  REPO: ${{ github.repository }}
                  TITLE: ${{ github.event.release.name }}
                  DISCUSSION_TITLE: "リリース反映チェックリスト"
                  CUSTOMERS_CSV: "株式会社A,株式会社B,株式会社C"
              run: bash scripts/update_discussion_table.sh
